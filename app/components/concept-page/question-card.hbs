{{! @glint-nocheck: not typesafe yet }}
<div class="border p-3 sm:p-4 bg-gray-50 rounded shadow-sm" data-test-question-card ...attributes>
  <div class="text-gray-800 mr-2 mb-2 border-b pt-1 pb-3">
    {{@question.queryHTML}}
  </div>

  <div class="flex flex-col -mx-3 sm:-mx-4 gap-px">
    {{#each this.options as |option optionIndex|}}
      <ConceptPage::QuestionCardOption
        class="px-4"
        @option={{option}}
        @isSubmitted={{this.hasSubmitted}}
        {{on "click" (fn (mut this.selectedOptionIndex) optionIndex)}}
        data-test-question-card-option
      />
    {{/each}}
  </div>

  <AnimatedContainer>
    {{#animated-if this.explanationIsVisible use=this.transition duration=200}}
      <div class="shadow-sm mt-4 p-4 border rounded {{if this.selectedOptionIsCorrect 'border-green-400 bg-green-50' 'border-gray-300 bg-white'}}">
        <div class="mb-4 font-semibold {{if this.selectedOptionIsCorrect 'text-green-700' 'text-gray-800'}}">
          {{#if this.selectedOptionIsCorrect}}
            <span class="mr-1">ðŸŽ‰</span>
            Correct!
          {{else}}
            <span class="mr-1">ðŸ‘€</span>
            Incorrect
          {{/if}}
        </div>

        <AnimatedContainer>
          {{#animated-value this.selectedOption.explanationHTML use=this.transition duration=200 as |v|}}
            <div class="leading-7 prose max-w-none {{if this.selectedOptionIsCorrect 'text-green-700' 'text-gray-800'}}">
              {{html-safe v}}
            </div>
          {{/animated-value}}
        </AnimatedContainer>
      </div>
    {{/animated-if}}
  </AnimatedContainer>

  <div class="flex flex-col sm:flex-row gap-x-2 gap-y-2 mt-4">
    {{#if this.hasSubmitted}}
      {{#if @shouldShowContinueButton}}
        <PrimaryButton @isDisabled={{is-empty this.selectedOptionIndex}} {{on "click" @onContinueButtonClick}} data-test-question-card-continue-button>
          <div class="flex items-center justify-center">
            {{svg-jar "arrow-down" class="w-4 h-4 mr-1 text-white"}}
            <span>Continue</span>
          </div>
        </PrimaryButton>

        <TertiaryButton {{on "click" this.handleILearnedSomethingButtonClick}}>
          {{#if this.didLearnSomething}}
            <span class="mr-2">ðŸ¤©</span>
          {{/if}}
          I learned something!
        </TertiaryButton>
      {{/if}}
    {{else}}
      <PrimaryButton @isDisabled={{is-empty this.selectedOptionIndex}} {{on "click" this.handleSubmitClick}} data-test-question-card-submit-button>Submit</PrimaryButton>
    {{/if}}

    {{#unless this.explanationIsVisible}}
      <TertiaryButton {{on "click" this.handleShowExplanationClick}}>Show explanation</TertiaryButton>
    {{/unless}}
  </div>
</div>