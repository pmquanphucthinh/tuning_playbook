<div class="mb-6 text-lg md:text-2xl" data-test-course-stage-solution-modal-title>
  <span class="text-gray-600">Stage #{{@courseStage.position}}:</span>
  <span class="font-bold text-gray-700">{{@courseStage.name}} </span>
</div>

<div class="flex flex-wrap items-center justify-between">
  <div class="flex items-center overflow-x-scroll pb-4 mb-2">
    {{#unless @courseStage.isFirst}}
      <CoursePage::CourseStageSolutionModal::HeaderTabLink
        @icon="user-group"
        @text="Solutions"
        @isActive={{eq @activeTab "community_solutions"}}
        {{on "click" (fn @onTabLinkClick "community_solutions")}}
      />
    {{/unless}}

    {{#if @currentSolution}}
      <CoursePage::CourseStageSolutionModal::HeaderTabLink
        @icon="code"
        @text="Verified Solution"
        @isActive={{eq @activeTab "verified_solution"}}
        @authorDetails={{@currentSolution.authorDetails}}
        @reviewersDetails={{@currentSolution.reviewersDetails}}
        {{on "click" (fn @onTabLinkClick "verified_solution")}}
      />
    {{/if}}

    {{#if @courseStage.sourceWalkthrough}}
      <CoursePage::CourseStageSolutionModal::HeaderTabLink
        @iconUrl={{@courseStage.course.logoUrl}}
        @text="Source Walkthrough"
        @isActive={{eq @activeTab "source_walkthrough"}}
        {{on "click" (fn @onTabLinkClick "source_walkthrough")}}
      />
    {{/if}}

    <CoursePage::CourseStageSolutionModal::HeaderTabLink
      @icon="chat"
      @text="Comments"
      @isActive={{eq @activeTab "comments"}}
      {{on "click" (fn @onTabLinkClick "comments")}}
    />
  </div>

  <div>
    {{#if (or (eq @activeTab "verified_solution") (eq @activeTab "explanation"))}}
      <CoursePage::CourseStageSolutionModal::LanguageDropdown
        @currentLanguage={{@currentSolution.language}}
        @requestedLanguage={{@requestedSolutionLanguage}}
        @courseStage={{@courseStage}}
        @onRequestedLanguageChange={{@onRequestedSolutionLanguageChange}}
        @onDidInsertDropdown={{@onDidInsertLanguageDropdown}}
        class="mb-6"
      />
    {{else if (eq @activeTab "community_solutions")}}
      <CoursePage::CourseStageSolutionModal::CommunitySolutionsLanguageDropdown
        @courseStage={{@courseStage}}
        @requestedLanguage={{@requestedSolutionLanguage}}
        @onRequestedLanguageChange={{@onRequestedSolutionLanguageChange}}
        @onDidInsertDropdown={{@onDidInsertLanguageDropdown}}
        class="mb-6"
      />
    {{/if}}
  </div>
</div>

{{#if (and (or (eq @activeTab "verified_solution") (eq @activeTab "explanation")) (not-eq @requestedSolutionLanguage @currentSolution.language))}}
  <div class="flex p-3 bg-blue-100 border border-blue-300 rounded shadow-sm mb-6 flex items-center" data-test-requested-language-not-available-notice>
    <div class="mr-3">
      {{svg-jar "information-circle" class="w-6 fill-current text-blue-400"}}
    </div>
    <div class="text-blue-900 text-sm">
      This stage doesn't have verified solutions available for
      {{@requestedSolutionLanguage.name}}
      yet, so we're showing solutions for
      <b class="text-blue-800">{{@currentSolution.language.name}}</b>
      instead.
    </div>
  </div>
{{/if}}