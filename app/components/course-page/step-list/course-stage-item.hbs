<CoursePage::StepList::ExpandedItem @class="relative {{@class}}" @willBeReplaced={{@willBeReplaced}} data-test-course-stage-item>
  <:content>
    <CoursePage::StepList::CourseStageItem::Header
      @courseStage={{@courseStage}}
      @status={{this.status}}
      @shouldShowUpgradePrompt={{this.shouldShowUpgradePrompt}}
      class="mb-6"
    />

    {{#if this.shouldShowUpgradePrompt}}
      <CoursePage::StepList::CourseStageItem::UpgradePrompt @class="mb-4" @color="yellow" />
    {{/if}}

    {{#if this.shouldShowPublishToGitHubPrompt}}
      <CoursePage::StepList::CourseStageItem::PublishToGithubPrompt @onPublishToGithubButtonClick={{@onPublishToGithubButtonClick}} class="mb-4" />
    {{/if}}

    <div class="text-gray-700 leading-7 prose" data-test-stage-instructions>
      {{#if this.shouldShowFirstStageHints}}
        <CoursePage::StepList::CourseStageItem::FirstStageHint class="mb-4" />
      {{/if}}

      {{this.instructionsHTML}}

      {{#if this.shouldShowFirstStageHints}}
        Since this is your first stage, we've included the code to pass this stage in your repository. Click on the
        <span class="underline text-blue-500 font-semibold" role="button" {{on "click" (fn @onViewSolutionButtonClick @courseStage)}}>Solution</span>
        button below for instructions on how to uncomment the code and pass this stage.
      {{/if}}
    </div>

    <CoursePage::StepList::CourseStageItem::ActionButtonList
      @courseStage={{@courseStage}}
      @repository={{@repository}}
      @onViewCommentsButtonClick={{@onViewCommentsButtonClick}}
      @onViewSolutionButtonClick={{@onViewSolutionButtonClick}}
      @onViewSourceWalkthroughButtonClick={{@onViewSourceWalkthroughButtonClick}}
      @onFeedbackButtonClick={{this.handleFeedbackActionButtonClicked}}
      @shouldHideFeedbackButtons={{this.automaticFeedbackFlowIsActive}}
    />

    {{#if (or this.manualFeedbackFlowIsActive this.automaticFeedbackFlowIsActive)}}
      <CoursePage::StepList::CourseStageItem::FeedbackPrompt
        @onClose={{this.handleFeedbackPromptClosed}}
        @onSubmit={{this.handleFeedbackSubmitted}}
        @courseStage={{@courseStage}}
        @repository={{@repository}}
        @wasTriggeredManually={{this.manualFeedbackFlowIsActive}}
        class="mt-6"
      />
    {{/if}}

    {{#if (and @courseStage.hasCompletionVideo this.statusIsComplete)}}
      <CoursePage::StepList::CourseStageItem::CompletionVideo @courseStage={{@courseStage}} class="mt-6" />
    {{/if}}

    {{#if (gt this.badgeAwards.length 0)}}
      <CoursePage::StepList::CourseStageItem::EarnedBadgeNotice @badgeAwards={{this.badgeAwards}} class="mt-6" />
    {{/if}}

    {{#if this.shouldShowCLIUsageInstructions}}
      <CoursePage::StepList::CourseStageItem::CliUsageInstructions class="mt-6" />
    {{/if}}

    {{#if (and this.statusIsComplete (eq @courseStage.nextStage @repository.activeStage))}}
      <div class="mt-6 flex">
        <PrimaryButton {{on "click" @onViewNextStageButtonClick}}>
          View Next Stage â†’
        </PrimaryButton>
      </div>
    {{/if}}
  </:content>

  <:footerContent>
    <CoursePage::StepList::CourseStageItem::Footer
      @courseStage={{@courseStage}}
      @status={{this.status}}
      @shouldShowUpgradePrompt={{this.shouldShowUpgradePrompt}}
      @repository={{@repository}}
    />
  </:footerContent>
</CoursePage::StepList::ExpandedItem>