<MembershipPage::Section @title="Recent Payments" {{did-insert this.handleDidInsert}} data-test-recent-payments-section>
  {{#if this.isLoading}}
    <div class="flex items-center mt-3">
      <img alt="Loading icon" src="/assets/images/icons/ripple-spinner.svg" class="w-4 h-4" />
      <span class="ml-3 text-gray-700">Loading recent payments...</span>
    </div>
  {{else if this.charges.firstObject}}
    <div class="grid grid-cols-3 gap-y-3">
      {{! Header }}
      <div class="border-b pb-2 text-gray-500 text-sm">Date</div>
      <div class="border-b pb-2 text-gray-500 text-sm text-right">Amount</div>
      <div class="border-b pb-2"></div>

      {{#each this.charges as |charge|}}
        <div class="text-gray-600 text-sm">{{moment-format charge.createdAt "LL"}}</div>

        <div class="font-semibold {{if charge.statusIsFailed 'text-red-600' 'text-gray-600'}} text-sm text-right">
          ${{charge.amountInDollars}}
        </div>

        <div class="flex items-center justify-end">
          {{#if (and charge.invoiceId charge.statusIsSucceeded)}}
            <a
              href="/invoices/{{charge.invoiceId}}/download"
              target="_blank"
              class="text-teal-500 hover:text-teal-600 font-semibold text-sm"
              data-test-download-invoice-link
              rel="noopener noreferrer"
            >
              Download Invoice
            </a>
          {{else if charge.statusIsFailed}}
            <span class="text-gray-600 text-sm font-semibold">Failed payment</span>
          {{/if}}
        </div>
      {{/each}}
    </div>
  {{else}}
    <div class="text-gray-700">
      No recent payments found.
    </div>
  {{/if}}
</MembershipPage::Section>